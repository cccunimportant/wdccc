<html>
<head>
  <meta charset="utf-8" />
</head>
<body>
<script src="../../gospa.js"></script>
<title> 少年科技人雜誌  / 2015年8月號 / Nand2Tetris 第 10 週 -- Compiler I: Syntax Analysis</title>

 [[少年科技人雜誌]](ymag:home)  / [[2015年8月號]](ymag201508:home) 

<h2 id="nand2tetris10compilerisyntaxanalysis">Nand2Tetris 第 10 週 -- Compiler I: Syntax Analysis</h2>

<p>所謂的編譯器，是一個將高階語言轉換成低階語言的程式。</p>

<p>在 nand2tetris 課程中，高階語言就是上一週介紹的 JACK 語言，而低階語言就是第 7-8 週介紹的虛擬機中介語言。</p>

<p>這兩週的任務就是要發展一個可以將 JACK 語言編譯成虛擬機語言的程式。</p>

<p>一個編譯器通常可以進一步分成好幾個組件，最簡單的分法是分成 1. 詞彙掃描 (Lexer) 2. 語法剖析 (Parser) 3. 目的碼產生 (Code Generator) 。</p>

<h3 id="">詞彙掃描</h3>

<p>詞彙掃描的工作，是將輸入程式的詞彙一個一個取出來，每次取一個。</p>

<p>舉例而言，以下是 nand2tetris 第 10 週投影片的一個詞彙掃描結果，您可以看到左邊的 <code>if (x &lt; 153) {let city == ”Paris”;}</code> 被斷成了一個一個的詞彙，變成像 <code>|if|(|x|&lt;|153|)|{|let|city|=|”Paris”|;|}|</code> 的樣子。只是途中的切分結果最後是用 XML 標記語言的方式呈現而已。</p>

<div class="figure"><img src="db/ymag201508/LexerExample.jpg"/><p class="caption">本圖來源: http://nand2tetris.org/course.php 第十週投影片</p></div>

<p>這種詞彙切分的程式寫起來並不難，您可以用正規表達式輕易地寫出來，或者是直接寫個小程式逐字讀取也行。</p>

<h3 id="">語法剖析</h3>

<p>一旦詞彙切分的程式建構完成，我們就可以進一步撰寫語法剖析的程式，但是要撰寫這類程式之前，我們必須先了解「語法」的概念。</p>

<p>還記得剛學英文的時候，老師會教所謂的文法，然後我們會看到像下列這樣的語法樹結構。</p>

<div class="figure"><img src="db/ymag201508/BNF_example.jpg"/><p class="caption"></p></div>

<p>這種結構也可以用在描述程式的語法上，以下就是一個簡單的「數學運算式」語法。</p>

<div class="figure"><img src="db/ymag201508/BNF_exp_example.jpg"/><p class="caption"></p></div>

<p>一但這種語法建構完成之後，我們就可以將按照語法寫出「剖析程式」(Parser) ，這樣就能完成語法剖析的動作了。</p>

<p>若想進一步理解有關語言處理和語法剖析的技術，也可以參考筆者寫的下列電子書。</p>

<ul>
<li><a href="http://ccckmit.github.io/BookLanguageProcessing/">語言處理技術</a></li>
</ul>

<p>在 nand2tetris 第 10 週投影片中描述了完整的 JACK 語言語法，如以下兩張圖片所示。</p>

<div class="figure"><img src="db/ymag201508/JackGrammer1.jpg"/><p class="caption">本圖來自 http://nand2tetris.org/course.php 第 10 週投影片</p></div>

<div class="figure"><img src="db/ymag201508/JackGrammer2.jpg"/><p class="caption">本圖來自 http://nand2tetris.org/course.php 第 10 週投影片</p></div>

<p>一但您完成了第 10 週作業中的剖析器之後，就可以把 JACK 語言轉換成以 XML 結構輸出的語法樹，以下是一個範例。</p>

<div class="figure"><img src="db/ymag201508/JackParsingTree.jpg"/><p class="caption">本圖來自 http://nand2tetris.org/course.php 第 10 週投影片</p></div>

<p>當剖析器完成之後，我們就可以開始插入輸出虛擬機中間碼的程式，將 JACK 語言的程式轉換成中間碼，然後再用先前的程式轉換成組合語言，最後用組譯器轉換成機器碼。</p>

<p>這樣我們就能完成一個高階語言編譯器了。</p>

</body>
</html>